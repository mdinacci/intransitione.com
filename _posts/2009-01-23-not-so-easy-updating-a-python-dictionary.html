--- 
layout: post
title: "Not so easy: updating a Python dictionary"
published: true
meta: 
  _edit_last: "1"
  blr_date: "2011-05-17"
tags: 
- Programming
type: post
status: publish
---
<br />Here's a problem that looks very easy but that it took me more time than I thought to solve.

Consider the following function prototype:
<pre lang="python">def updateDictValue(dictionary, keyPath, newValue)</pre>
<em>dictionary</em> is a normal Python dict, <em>keyPath</em> is a string referring to a key inside dictionary and <em>newValue</em> is the new value which should be put at the key correspondent to <em>keyPath</em>.
<!--more-->

An example:
<pre lang="python">dictionary = {"a": {"b": {"c": {"d": 3}}}}
keypath = "a.b.c.d"
newValue = 4</pre>
Now write the body of the function so that at the end of the execution <em>dictionary</em> is
<pre lang="python">{"a": {"b": {"c": {"d": 4}}}}</pre>

<br />My not so pretty solution is here:
<pre lang="python">def updateDictValue(dictionary, keyPath, newValue):
    tokens = keyPath.split(".")
    if len(tokens) > 1:
        prev = dictionary[tokens[0]]
        for token in tokens[1:]:
            if token == tokens[-1]:
                prev[token] = newValue
            else:
                 prev = prev.get(token)
        return dictionary
    else:
        dictionary[keyPath] = newValue
        return dictionary
</pre>
<br />At the beginning I simply thought using <em>eval</em> but you can't assign a value inside the eval expression so that won't work, and even if you could, how do you specify the correct type ? You're limited to the types offered by the string formatting options in Python (%s, %d etc...).

Now that I've posted here I'm sure I'm going to implement it faster next time but I'm curios about other ways of solving this problem. Any ideas ?
